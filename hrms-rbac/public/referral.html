<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Infinite Hunters â€“ Referral Page</title>

<style>
body {
    font-family: "Times New Roman", Times, serif;
    background:#f2f4f7;
    padding:16px;
    margin:0;
}
.container {
    background:#fff;
    padding:16px;
    border-radius:6px;
    width:100%;
}
h2 {
    background:#0a3d62;
    color:#fff;
    padding:10px;
    font-size:20px;
    text-align:center;
    margin-bottom:12px;
}
.section h3 {
    font-size:17px;
    margin:14px 0 8px;
    border-bottom:2px solid navy;
    padding-bottom:4px;
    color: navy;
}
.grid {
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:12px 30px;
}
.field-box {
    display:flex;
    flex-direction:column;
    min-height:72px;
}
label {
    font-weight:bold;
    margin-bottom:4px;
    font-size:14px;
    color: navy;
}
input, select {
    height:38px;
    padding:6px 8px;
    font-size:14px;
    border:2px solid navy;
    border-radius:4px;
    width:100%;
    box-sizing:border-box;
}
.row {
    display:flex;
    gap:6px;
    align-items:center;
}
.add-btn {
    height:38px;
    padding:0 12px;
    background:#0a3d62;
    color:#fff;
    border:none;
    border-radius:4px;
    cursor:pointer;
    font-size:16px;
}
.counter-box {
    display:flex;
    gap:16px;
    margin-bottom:14px;
}
.counter {
    flex:1;
    min-height:90px;
    background:#0a3d62;
    border-radius:6px;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    color:#fff;
}
.submit-btn {
    margin:20px auto 0;
    display:block;
    width:220px;
    height:40px;
    background:#198754;
    color:#fff;
    border:none;
    font-size:15px;
    border-radius:4px;
    cursor:pointer;
}
.error {
    border-color:red !important;
}
.delete-btn {
    height:38px;
    padding:0 8px;
    background:red;
    color:#fff;
    border:none;
    border-radius:4px;
    cursor:pointer;
    font-size:16px;
}
</style>
</head>

<body>
  <nav style="background:#0a3d62;padding:10px;text-align:center;">
    <a href="/referral" style="color:white;margin:0 10px;">Referral</a>
    <a href="/lineup" style="color:white;margin:0 10px;">Line-up</a>
    <a href="/onboardingsample" style="color:white;margin:0 10px;">Onboarding</a>
    <a href="/onboarded-list" style="color:white;margin:0 10px;">Onboarded</a>
    <a href="/bank-change" style="color:white;margin:0 10px;">Bank Change</a>
    <a href="/logout" style="color:#ffd700;margin-left:20px;">Logout</a>
</nav>


<div class="container">
<h2>Referral Management â€“ Admin</h2>

<div class="counter-box">
    <div class="counter"><h3>Referrals</h3><p>30</p></div>
    <div class="counter"><h3>Interview Line-up</h3><p>5</p></div>
    <div class="counter"><h3>Selected</h3><p>3</p></div>
    <div class="counter"><h3>Onboarded</h3><p>3</p></div>
</div>

<form method="POST" action="/save-referral" onsubmit="return validateForm()">



<!-- Referral Details -->
<div class="section">
<h3>Referral Details</h3>
<div class="grid">

<div class="field-box">
<label>Sourced By *</label>
<select required>
<option value="">Select</option>
<option>Recruiter</option>
<option>Freelancer</option>
</select>
</div>

<div class="field-box">
<label>Recruiter *</label>
<div class="row">
<select id="recruiter" required>
<option value="">Select</option>
<option>Swiggy</option>
<option>Zomato</option>
<option>Zepto</option>
<option>Uber Eats</option>
</select>
<button type="button" class="add-btn" onclick="addOption('recruiter','Recruiter')">+</button>
<button type="button" class="delete-btn" onclick="deleteOption('recruiter')">ðŸ—‘</button>
</div>
</div>

</div>
</div>

<!-- Client & Location -->
<div class="section">
<h3>Client & Location</h3>
<div class="grid">

<div class="field-box">
<label>Client *</label>
<div class="row">
<select id="client" required>
<option value="">Select</option>
<option>Swiggy - Instamart</option>
<option>Zomato</option>
</select>
<button type="button" class="add-btn" onclick="addOption('client','Client')">+</button>
<button type="button" class="delete-btn" onclick="deleteOption('client')">ðŸ—‘</button>
</div>
</div>

<div class="field-box">
<label>State *</label>
<div class="row">
<select id="state" required>
<option value="">Select</option>
<option>Tamil Nadu</option>
<option>Karnataka</option>
</select>
<button type="button" class="add-btn" onclick="addOption('state','State')">+</button>
<button type="button" class="delete-btn" onclick="deleteOption('state')">ðŸ—‘</button>
</div>
</div>

<div class="field-box">
<label>City *</label>
<div class="row">
<select id="city" required>
<option value="">Select</option>
<option>Chennai</option>
<option>Bangalore</option>
</select>
<button type="button" class="add-btn" onclick="addOption('city','City')">+</button>
<button type="button" class="delete-btn" onclick="deleteOption('city')">ðŸ—‘</button>
</div>
</div>

</div>
</div>

<!-- Candidate Details -->
<div class="section">
<h3>Candidate Details</h3>
<div class="grid">

<div class="field-box">
<label>Candidate Name *</label>
<input type="text" id="candidateName"
       placeholder="Only letters allowed"
       oninput="validateName(this)" required>
</div>

<div class="field-box">
<label>Mobile Number *</label>
<input type="text" id="mobile"
       maxlength="10"
       placeholder="10 digit mobile number"
       oninput="validateMobile(this)" required>
</div>

<div class="field-box">
<label>Designation *</label>
<select required>
<option value="">Select</option>
<option>Picker</option>
<option>Packer</option>
<option>Loader</option>
<option>Delivery Executive</option>
</select>
</div>

<div class="field-box">
<label>Expected DOJ *</label>
<input type="date" id="doj" required>
</div>

<div class="field-box">
<label>Status *</label>
<select required>
<option value="">Select</option>
<option>Referred</option>
<option>Interview Line-up</option>
<option>Selected</option>
<option>Onboarded</option>
</select>
</div>

</div>
</div>

<button type="submit" class="submit-btn">Save Referral</button>
</form>
</div>

<script>
function addOption(selectId, label) {
    let value = prompt("Enter new " + label);
    if (!value) return;

    value = value.trim();

    // Only letters and spaces
    if (!/^[A-Za-z ]+$/.test(value)) {
        alert(label + " must contain only letters");
        return;
    }

    let select = document.getElementById(selectId);

    // Check duplicates
    for (let i = 0; i < select.options.length; i++) {
        if (select.options[i].value.toLowerCase() === value.toLowerCase()) {
            alert(label + " already exists");
            return;
        }
    }

    let option = document.createElement("option");
    option.value = value;
    option.text = value;
    select.add(option);
    select.value = value;
}

function deleteOption(selectId) {
    let select = document.getElementById(selectId);
    if (select.selectedIndex <= 0) {
        alert("Select an item to delete");
        return;
    }
    if (confirm("Are you sure you want to delete this entry?")) {
        select.remove(select.selectedIndex);
    }
}

/* Candidate Name â€“ letters only */
function validateName(input) {
    const regex = /^[A-Za-z ]*$/;
    input.classList.toggle("error", !regex.test(input.value));
}

/* Mobile â€“ exactly 10 digits */
function validateMobile(input) {
    input.classList.toggle("error", !/^[0-9]{10}$/.test(input.value));
}

/* Form Submit Validation */
function validateForm() {
    if (document.querySelector(".error")) {
        alert("Please fix highlighted fields");
        return false;
    }
    return true;
}

/* DOJ â€“ disable past dates */
window.onload = function () {
    const today = new Date().toISOString().split("T")[0];
    document.getElementById("doj").setAttribute("min", today);
};

</script>
<script>
function submitReferral(e) {
    e.preventDefault();

    if (!validateForm()) return;

    const payload = {
        sourcedBy: document.querySelector("select").value,
        recruiter: document.getElementById("recruiter").value,
        client: document.getElementById("client").value,
        state: document.getElementById("state").value,
        city: document.getElementById("city").value,

        candidateName: document.getElementById("candidateName").value,
        mobile: document.getElementById("mobile").value,
        designation: document.querySelectorAll("select")[5].value,
        expectedDoj: document.getElementById("doj").value,
        status: document.querySelectorAll("select")[6].value
    };

    fetch("/api/referral", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
    })
    .then(res => res.json())
    .then(data => {
        if (data.success) {
            alert("Referral saved successfully");
            location.reload();
        } else {
            alert("Failed to save referral");
        }
    });
}
</script>


</body>


</html> 